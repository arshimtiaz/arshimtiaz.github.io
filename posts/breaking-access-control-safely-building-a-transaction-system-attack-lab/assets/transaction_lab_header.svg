<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 320" role="img" aria-labelledby="title desc">
  <title id="title">Transaction System Attack Lab</title>
  <desc id="desc">Diagram-style header showing three services and trust boundaries.</desc>
  <defs>
    <linearGradient id="bg" x1="0" x2="1" y1="0" y2="1">
      <stop offset="0%" stop-color="#0f172a"/>
      <stop offset="100%" stop-color="#1e293b"/>
    </linearGradient>
  </defs>
  <rect width="800" height="320" fill="url(#bg)"/>
  <text x="400" y="60" text-anchor="middle" fill="#e5e7eb" font-size="26" font-family="system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif">
    Transaction System Attack Lab
  </text>
  <text x="400" y="92" text-anchor="middle" fill="#9ca3af" font-size="16" font-family="system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif">
    Modelling broken access control and IDOR in a small multi-service platform
  </text>

  <!-- Client -->
  <circle cx="90" cy="190" r="26" fill="#0ea5e9"/>
  <rect x="70" y="220" width="40" height="26" rx="4" fill="#e5e7eb"/>
  <text x="90" y="270" text-anchor="middle" fill="#e5e7eb" font-size="13" font-family="system-ui">Client</text>

  <!-- Arrows -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#e5e7eb" />
    </marker>
  </defs>

  <!-- auth-service box -->
  <rect x="180" y="150" width="160" height="100" rx="10" fill="#111827" stroke="#38bdf8" stroke-width="2"/>
  <text x="260" y="185" text-anchor="middle" fill="#e5e7eb" font-size="15" font-family="system-ui">auth-service</text>
  <text x="260" y="210" text-anchor="middle" fill="#9ca3af" font-size="12" font-family="system-ui">issues JWT (sub = user_id)</text>

  <!-- accounts-service box -->
  <rect x="380" y="150" width="190" height="100" rx="10" fill="#111827" stroke="#4ade80" stroke-width="2"/>
  <text x="475" y="185" text-anchor="middle" fill="#e5e7eb" font-size="15" font-family="system-ui">accounts-service</text>
  <text x="475" y="210" text-anchor="middle" fill="#9ca3af" font-size="12" font-family="system-ui">/accounts/{id}/balance</text>

  <!-- audit-service box -->
  <rect x="610" y="150" width="150" height="100" rx="10" fill="#111827" stroke="#f97316" stroke-width="2"/>
  <text x="685" y="185" text-anchor="middle" fill="#e5e7eb" font-size="15" font-family="system-ui">audit-service</text>
  <text x="685" y="210" text-anchor="middle" fill="#9ca3af" font-size="12" font-family="system-ui">logs security events</text>

  <!-- Flows -->
  <line x1="130" y1="190" x2="180" y2="190" stroke="#e5e7eb" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="340" y1="190" x2="380" y2="190" stroke="#e5e7eb" stroke-width="2" marker-end="url(#arrow)" />
  <line x1="570" y1="190" x2="610" y2="190" stroke="#e5e7eb" stroke-width="2" marker-end="url(#arrow)" />

  <!-- Trust boundaries -->
  <line x1="360" y1="135" x2="360" y2="265" stroke="#6b7280" stroke-width="2" stroke-dasharray="4 6" />
  <line x1="590" y1="135" x2="590" y2="265" stroke="#6b7280" stroke-width="2" stroke-dasharray="4 6" />

  <text x="270" y="140" text-anchor="middle" fill="#9ca3af" font-size="11" font-family="system-ui">Trust boundary</text>
  <text x="500" y="140" text-anchor="middle" fill="#9ca3af" font-size="11" font-family="system-ui">Trust boundary</text>
</svg>
